<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with measure.sec • measure.sec</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with measure.sec">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">measure.sec</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/getting-started.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides">
<li><h6 class="dropdown-header" data-toc-skip>How-to Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/triple-detection.html">Multi-Detector SEC</a></li>
    <li><a class="dropdown-item" href="../articles/mals-detection.html">MALS Detection</a></li>
    <li><a class="dropdown-item" href="../articles/lals-rals-detection.html">LALS/RALS Detection</a></li>
    <li><a class="dropdown-item" href="../articles/protein-sec.html">Protein SEC Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/copolymer-analysis.html">Copolymer Composition</a></li>
    <li><a class="dropdown-item" href="../articles/calibration-management.html">Calibration Management</a></li>
    <li><a class="dropdown-item" href="../articles/system-suitability.html">System Suitability</a></li>
    <li><a class="dropdown-item" href="../articles/branching-analysis.html">Polymer Branching</a></li>
    <li><a class="dropdown-item" href="../articles/exporting-results.html">Exporting Results</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Explanation</h6></li>
    <li><a class="dropdown-item" href="../articles/sec-concepts.html">SEC Concepts Guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Reference</h6></li>
    <li><a class="dropdown-item" href="../articles/sec-analysis.html">Comprehensive SEC Analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JamesHWade/measure-sec/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with measure.sec</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JamesHWade/measure-sec/blob/main/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-youll-learn">What You’ll Learn<a class="anchor" aria-label="anchor" href="#what-youll-learn"></a>
</h2>
<p>By the end of this tutorial, you will be able to:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Load and convert</strong> SEC chromatogram data into the
measure format</li>
<li>
<strong>Build a recipe</strong> that processes your detector
signals</li>
<li>
<strong>Apply calibration</strong> to convert retention time to
molecular weight</li>
<li>
<strong>Calculate MW averages</strong> (Mn, Mw, Mz, dispersity)</li>
</ol>
<p><strong>Time to complete</strong>: ~15 minutes</p>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>Before starting, you should have: - Basic R knowledge (data frames,
pipes, functions) - R and RStudio installed - No prior SEC/GPC knowledge
required (we’ll cover the basics)</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>measure.sec</strong> provides preprocessing steps for Size
Exclusion Chromatography (SEC) and Gel Permeation Chromatography (GPC)
data analysis. It extends the <a href="https://github.com/JamesHWade/measure" class="external-link">measure</a> package using
the <a href="https://recipes.tidymodels.org/" class="external-link">recipes</a> framework.</p>
</div>
<div class="section level2">
<h2 id="what-is-secgpc">What is SEC/GPC?<a class="anchor" aria-label="anchor" href="#what-is-secgpc"></a>
</h2>
<p><strong>Size Exclusion Chromatography (SEC)</strong>, also known as
<strong>Gel Permeation Chromatography (GPC)</strong>, separates
molecules by size. Larger molecules elute faster (excluded from pores),
smaller molecules elute slower (enter pores). This lets you determine
<strong>molecular weight averages</strong> (Mn, Mw, Mz) and
<strong>dispersity</strong> (distribution breadth).</p>
<p>SEC data consists of <strong>chromatograms</strong> (detector
response vs. elution time). Common detectors include <strong>RI</strong>
(concentration), <strong>UV</strong> (chromophores), and <strong>light
scattering</strong> (absolute MW). This package processes these signals
to extract molecular weight information.</p>
</div>
<div class="section level2">
<h2 id="workflow-overview">Workflow Overview<a class="anchor" aria-label="anchor" href="#workflow-overview"></a>
</h2>
<p>The typical SEC analysis workflow follows these steps:</p>
<pre><code>┌─────────────────────────────────────────────────────────────────────────┐
│                        SEC Analysis Workflow                            │
└─────────────────────────────────────────────────────────────────────────┘

  ┌──────────────┐     ┌──────────────┐     ┌──────────────┐
  │   Raw Data   │────▶│ Preprocess   │────▶│  Calibrate   │
  │ (CSV/Export) │     │  Signals     │     │   MW Scale   │
  └──────────────┘     └──────────────┘     └──────────────┘
         │                    │                    │
         │                    │                    │
         ▼                    ▼                    ▼
   • Detector signals   • Baseline correct  • Apply standards
   • Elution times      • Align detectors   • Or use MALS for
   • Sample metadata    • Convert units       absolute MW
                                                   │
                                                   ▼
                        ┌──────────────────────────────────────┐
                        │          Calculate Results           │
                        │  • MW averages (Mn, Mw, Mz)         │
                        │  • Dispersity                        │
                        │  • MW distribution                   │
                        │  • Aggregate/fragment %              │
                        └──────────────────────────────────────┘</code></pre>
<p>In measure.sec, each box becomes one or more <strong>recipe
steps</strong>. You chain these steps together into a reproducible
analysis pipeline.</p>
<div class="section level3">
<h3 id="basic-workflow-overview">Basic Workflow Overview<a class="anchor" aria-label="anchor" href="#basic-workflow-overview"></a>
</h3>
<p>A typical SEC analysis starts with raw detector signals, converts
them to the measure format, applies baseline correction, processes
detector signals with appropriate normalization factors, then either
applies calibration from standards (conventional) or uses light
scattering for absolute molecular weight (MALS).</p>
<pre class="mermaid"><code>flowchart TD
    A[Raw Chromatogram&lt;br&gt;RI, UV, MALS signals] --&gt; B[step_measure_input_long&lt;br&gt;Convert to measure format]
    B --&gt; C[step_sec_baseline&lt;br&gt;Baseline correction]
    C --&gt; D[step_sec_ri / step_sec_uv&lt;br&gt;Detector processing with dn/dc or ε]
    D --&gt; E{Calibration&lt;br&gt;method?}
    E --&gt;|"Standards available&lt;br&gt;(same polymer type)"| F[step_sec_conventional_cal&lt;br&gt;Polynomial fit to standards]
    E --&gt;|"MALS detector&lt;br&gt;(absolute MW needed)"| G[step_sec_mals&lt;br&gt;Angular extrapolation&lt;br&gt;Zimm/Debye/Berry]
    F --&gt; H[step_sec_mw_averages&lt;br&gt;Calculate Mn, Mw, Mz]
    G --&gt; I[Absolute MW &amp; Rg&lt;br&gt;directly from MALS]
    H --&gt; J[Results&lt;br&gt;MW averages, distributions, plots]
    I --&gt; J

    style A fill:#e1f5fe
    style J fill:#c8e6c9</code></pre>
<p><em>Choose <strong>conventional calibration</strong> when you have
narrow MW standards of the same polymer type. Choose
<strong>MALS</strong> when you need absolute MW without polymer-specific
standards or when analyzing unknown polymers.</em></p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub</span></span>
<span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"JamesHWade/measure"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"JamesHWade/measure-sec"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jameshwade.github.io/measure/" class="external-link">measure</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: recipes</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'recipes'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     step</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JamesHWade/measure-sec" class="external-link">measure.sec</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-data-model">The Data Model<a class="anchor" aria-label="anchor" href="#the-data-model"></a>
</h2>
<p>SEC data in measure.sec uses the <strong>measure</strong> package’s
nested tibble structure. Understanding this structure is key to working
effectively with the package.</p>
<div class="section level3">
<h3 id="measure_tbl-a-single-chromatogram">measure_tbl: A Single Chromatogram<a class="anchor" aria-label="anchor" href="#measure_tbl-a-single-chromatogram"></a>
</h3>
<p>A <strong><code>measure_tbl</code></strong> is a tibble (data frame)
representing a single chromatogram with two required columns:</p>
<ul>
<li>
<strong><code>location</code></strong>: The x-axis values—typically
elution time (minutes) or elution volume (mL)</li>
<li>
<strong><code>value</code></strong>: The y-axis values—detector
response (mV, AU, or processed units)</li>
</ul>
<p>Think of it as one line on a chromatogram plot. For example, an RI
detector signal from one injection is stored as a
<code>measure_tbl</code>.</p>
</div>
<div class="section level3">
<h3 id="measure_list-multiple-chromatograms-internal-format">measure_list: Multiple Chromatograms (Internal Format)<a class="anchor" aria-label="anchor" href="#measure_list-multiple-chromatograms-internal-format"></a>
</h3>
<p>A <strong><code>measure_list</code></strong> is a list column
containing multiple <code>measure_tbl</code> objects. This is the
<strong>internal format</strong> used by measure.sec recipe steps—you
typically won’t create this yourself. Instead,
<code><a href="https://jameshwade.github.io/measure/reference/step_measure_input_long.html" class="external-link">step_measure_input_long()</a></code> converts your raw data into this
format automatically.</p>
<p><strong>After conversion</strong>, your data will look like this:</p>
<pre><code>┌──────────────────────────────────────────────────────────────┐
│  sample_id   known_mw   dn_dc       ri                      │
├──────────────────────────────────────────────────────────────┤
│  "PS-50K"    50000      0.185       &lt;measure_list[1]&gt;       │
│  "PS-100K"   100000     0.185       &lt;measure_list[1]&gt;       │
│  "PMMA-75K"  75000      0.084       &lt;measure_list[1]&gt;       │
└──────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
                            Each entry contains a measure_tbl:
                              location │ value
                              ─────────┼────────
                              5.0      │ 0.002
                              5.1      │ 0.015
                              5.2      │ 0.089
                              ...      │ ...</code></pre>
<p>This nested structure has several advantages:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Tidy organization</strong>: Each row is one sample with all
its metadata and chromatogram(s)</li>
<li>
<strong>Batch processing</strong>: Apply the same recipe to many
samples at once</li>
<li>
<strong>Multiple detectors</strong>: Store RI, UV, and MALS signals
as separate nested columns</li>
<li>
<strong>Metadata preservation</strong>: Sample properties like
<code>dn_dc</code> or <code>known_mw</code> travel with the
chromatogram</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="example-dataset">Example Dataset<a class="anchor" aria-label="anchor" href="#example-dataset"></a>
</h2>
<p>The package includes <code>sec_triple_detect</code>, a synthetic
multi-detector SEC dataset in <strong>long format</strong> (one row per
time point). This is a good starting point for learning the workflow
before analyzing your own data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the example dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sec_triple_detect</span>, package <span class="op">=</span> <span class="st">"measure.sec"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the structure - this is LONG format data (one row per time point)</span></span>
<span><span class="co"># The signal columns (ri_signal, uv_signal, mals_signal) are numeric vectors</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">sec_triple_detect</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 24,012</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ sample_id        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PS-1K"<span style="color: #949494;">, </span>"PS-1K"<span style="color: #949494;">, </span>"PS-1K"<span style="color: #949494;">, </span>"PS-1K"<span style="color: #949494;">, </span>"PS-1K"<span style="color: #949494;">, </span>"PS-1K"<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ sample_type      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "standard"<span style="color: #949494;">, </span>"standard"<span style="color: #949494;">, </span>"standard"<span style="color: #949494;">, </span>"standard"<span style="color: #949494;">, </span>"stan…</span></span>
<span><span class="co">#&gt; $ polymer_type     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "polystyrene"<span style="color: #949494;">, </span>"polystyrene"<span style="color: #949494;">, </span>"polystyrene"<span style="color: #949494;">, </span>"polysty…</span></span>
<span><span class="co">#&gt; $ elution_time     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.00<span style="color: #949494;">, </span>5.01<span style="color: #949494;">, </span>5.02<span style="color: #949494;">, </span>5.03<span style="color: #949494;">, </span>5.04<span style="color: #949494;">, </span>5.05<span style="color: #949494;">, </span>5.06<span style="color: #949494;">, </span>5.07<span style="color: #949494;">, </span>5.08<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ri_signal        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.926392e-04<span style="color: #949494;">, </span>0.000000e+00<span style="color: #949494;">, </span>3.199253e-04<span style="color: #949494;">, </span>4.197175e-0…</span></span>
<span><span class="co">#&gt; $ uv_signal        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0002034583<span style="color: #949494;">, </span>0.0000000000<span style="color: #949494;">, </span>0.0000000000<span style="color: #949494;">, </span>0.000000000…</span></span>
<span><span class="co">#&gt; $ mals_signal      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.370385e-05<span style="color: #949494;">, </span>3.483481e-05<span style="color: #949494;">, </span>3.102092e-05<span style="color: #949494;">, </span>3.261962e-0…</span></span>
<span><span class="co">#&gt; $ known_mw         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">, </span>1000<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ known_dispersity <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">, </span>1.05<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ dn_dc            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.185<span style="color: #949494;">, </span>0.185<span style="color: #949494;">, </span>0.185<span style="color: #949494;">, </span>0.185<span style="color: #949494;">, </span>0.185<span style="color: #949494;">, </span>0.185<span style="color: #949494;">, </span>0.185<span style="color: #949494;">, </span>0.18…</span></span>
<span><span class="co">#&gt; $ extinction_coef  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2<span style="color: #949494;">, </span>1.2…</span></span></code></pre></div>
<p>The dataset contains:</p>
<ul>
<li>
<strong>12 polymer samples</strong>: polystyrene (PS), PMMA, PEG,
and copolymers</li>
<li>
<strong>~2,000 time points per sample</strong>: giving 24,012 total
rows</li>
<li>
<strong>Three detector signals</strong>: RI, UV, and MALS (as
numeric columns)</li>
<li>
<strong>Known molecular weights</strong>: For validating your
analysis</li>
<li>
<strong>Optical constants</strong>: dn/dc and extinction
coefficients (needed for quantitative analysis)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the unique samples in the dataset</span></span>
<span><span class="co"># Each sample_id represents one injection; the chromatogram spans many rows</span></span>
<span><span class="va">sec_triple_detect</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">sample_type</span>, <span class="va">polymer_type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 3</span></span></span>
<span><span class="co">#&gt;    sample_id sample_type polymer_type</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> PS-1K     standard    polystyrene </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> PS-10K    standard    polystyrene </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> PS-50K    standard    polystyrene </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> PS-100K   standard    polystyrene </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> PS-500K   standard    polystyrene </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> PMMA-Low  sample      pmma        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> PMMA-Med  sample      pmma        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> PMMA-High sample      pmma        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> PEG-5K    sample      peg         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> PEG-20K   sample      peg         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Copoly-A  sample      copolymer   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Copoly-B  sample      copolymer</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-workflow-ri-detector-analysis">Basic Workflow: RI Detector Analysis<a class="anchor" aria-label="anchor" href="#basic-workflow-ri-detector-analysis"></a>
</h2>
<p>Let’s walk through a complete analysis of a polystyrene sample using
the RI detector. This demonstrates the core pattern you’ll use for all
SEC analysis.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select a single polystyrene standard for this example</span></span>
<span><span class="co"># In practice, you'd often process many samples at once</span></span>
<span><span class="va">ps_sample</span> <span class="op">&lt;-</span> <span class="va">sec_triple_detect</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample_id</span> <span class="op">==</span> <span class="st">"PS-50K"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View sample info - note this is still long format (many rows per sample)</span></span>
<span><span class="va">ps_sample</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">polymer_type</span>, <span class="va">known_mw</span>, <span class="va">elution_time</span>, <span class="va">ri_signal</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   sample_id polymer_type known_mw elution_time ri_signal</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PS-50K    polystyrene     <span style="text-decoration: underline;">50</span>000         5     0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PS-50K    polystyrene     <span style="text-decoration: underline;">50</span>000         5.01  0.000<span style="text-decoration: underline;">279</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PS-50K    polystyrene     <span style="text-decoration: underline;">50</span>000         5.02  0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PS-50K    polystyrene     <span style="text-decoration: underline;">50</span>000         5.03  0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> PS-50K    polystyrene     <span style="text-decoration: underline;">50</span>000         5.04  0.000<span style="text-decoration: underline;">842</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> PS-50K    polystyrene     <span style="text-decoration: underline;">50</span>000         5.05  0.000<span style="text-decoration: underline;">483</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="step-1-create-a-recipe">Step 1: Create a Recipe<a class="anchor" aria-label="anchor" href="#step-1-create-a-recipe"></a>
</h3>
<p><strong>Recipes</strong> define a sequence of preprocessing steps.
Think of a recipe as a blueprint for your analysis—it describes
<em>what</em> to do, but doesn’t do it yet. This separation lets you
define the workflow once and apply it to many samples.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start a recipe with your data</span></span>
<span><span class="co"># The formula specifies: predictor columns ~ grouping column</span></span>
<span><span class="co"># sample_id identifies which rows belong to each chromatogram</span></span>
<span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span></span>
<span>  <span class="va">ri_signal</span> <span class="op">+</span> <span class="va">elution_time</span> <span class="op">+</span> <span class="va">dn_dc</span> <span class="op">~</span> <span class="va">sample_id</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ps_sample</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/roles.html" class="external-link">update_role</a></span><span class="op">(</span><span class="va">sample_id</span>, new_role <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Convert the ri_signal column to measure format</span></span>
<span>  <span class="co"># This step tells recipes how to interpret your chromatogram data</span></span>
<span>  <span class="fu"><a href="https://jameshwade.github.io/measure/reference/step_measure_input_long.html" class="external-link">step_measure_input_long</a></span><span class="op">(</span></span>
<span>    <span class="va">ri_signal</span>,</span>
<span>    location <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">elution_time</span><span class="op">)</span>,</span>
<span>    col_name <span class="op">=</span> <span class="st">"ri"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-add-preprocessing-steps">Step 2: Add Preprocessing Steps<a class="anchor" aria-label="anchor" href="#step-2-add-preprocessing-steps"></a>
</h3>
<p>Chain additional steps using the pipe (<code>|&gt;</code>). Each step
transforms the data in sequence:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span></span>
<span>  <span class="va">ri_signal</span> <span class="op">+</span> <span class="va">elution_time</span> <span class="op">+</span> <span class="va">dn_dc</span> <span class="op">~</span> <span class="va">sample_id</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ps_sample</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/roles.html" class="external-link">update_role</a></span><span class="op">(</span><span class="va">sample_id</span>, new_role <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># First: convert raw signal to measure format</span></span>
<span>  <span class="fu"><a href="https://jameshwade.github.io/measure/reference/step_measure_input_long.html" class="external-link">step_measure_input_long</a></span><span class="op">(</span></span>
<span>    <span class="va">ri_signal</span>,</span>
<span>    location <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">elution_time</span><span class="op">)</span>,</span>
<span>    col_name <span class="op">=</span> <span class="st">"ri"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Second: correct the baseline (removes drift and offset)</span></span>
<span>  <span class="fu"><a href="../reference/step_sec_baseline.html">step_sec_baseline</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="st">"ri"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Third: process RI signal using the sample's dn/dc value</span></span>
<span>  <span class="co"># Dividing by dn/dc converts the RI signal to concentration-proportional units</span></span>
<span>  <span class="fu"><a href="../reference/step_sec_ri.html">step_sec_ri</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="st">"ri"</span>, dn_dc_column <span class="op">=</span> <span class="st">"dn_dc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-prep-and-bake">Step 3: Prep and Bake<a class="anchor" aria-label="anchor" href="#step-3-prep-and-bake"></a>
</h3>
<p>Two functions execute your recipe:</p>
<ul>
<li>
<strong><code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code></strong>: Learns any required parameters
from the training data (like baseline fit coefficients)</li>
<li>
<strong><code><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake()</a></code></strong>: Applies the transformations to
produce results</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prep: Learn parameters from the data</span></span>
<span><span class="va">prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">rec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bake: Apply transformations (new_data = NULL means use the training data)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">prepped</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the processed data - ri now contains the baseline-corrected,</span></span>
<span><span class="co"># concentration-converted chromatogram</span></span>
<span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">ri</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   sample_id          ri</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;meas&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PS-50K    <span style="color: #949494;">[2,001 × 2]</span></span></span></code></pre></div>
<blockquote>
<p><strong>Why two steps?</strong> This design lets you prep once on
training data (like calibration standards), then bake on new samples
without re-learning parameters. It also makes your analysis
reproducible.</p>
</blockquote>
<hr>
<p><strong>✓ Checkpoint</strong>: You’ve successfully converted raw
detector data into the measure format and applied baseline correction.
Your <code>result</code> tibble now contains a processed <code>ri</code>
column ready for calibration.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="molecular-weight-averages">Molecular Weight Averages<a class="anchor" aria-label="anchor" href="#molecular-weight-averages"></a>
</h2>
<p>The most common outputs from SEC analysis are <strong>molecular
weight averages</strong>: - <strong>Mn (number-average)</strong>:
Emphasizes lower MW species - <strong>Mw (weight-average)</strong>:
Emphasizes higher MW species - <strong>Mz (z-average)</strong>: Even
more sensitive to high MW species - <strong>Dispersity (Mw/Mn)</strong>:
Measures breadth of the MW distribution (1.0 = monodisperse)</p>
<p>Use <code><a href="../reference/step_sec_mw_averages.html">step_sec_mw_averages()</a></code> to calculate these. This step
requires that the x-axis (location) values already represent
log₁₀(MW)—which is what <code><a href="../reference/step_sec_conventional_cal.html">step_sec_conventional_cal()</a></code>
provides. See the Calibration section below for the complete
workflow.</p>
</div>
<div class="section level2">
<h2 id="calibration-curves">Calibration Curves<a class="anchor" aria-label="anchor" href="#calibration-curves"></a>
</h2>
<p>Most SEC analysis requires <strong>calibration</strong> to convert
retention time to molecular weight. The most common approach uses
<strong>narrow standards</strong>—polymers with known molecular weights
and low dispersity—to build a calibration curve.</p>
<blockquote>
<p><strong>Note</strong>: If you have a light scattering detector
(MALS), you can determine absolute molecular weights without
calibration. See <code><a href="../articles/triple-detection.html">vignette("triple-detection")</a></code> for
details.</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load polystyrene narrow standards</span></span>
<span><span class="co"># These are well-characterized polymers used to build the calibration curve</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sec_ps_standards</span>, package <span class="op">=</span> <span class="st">"measure.sec"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the standards - each has a known peak molecular weight (Mp)</span></span>
<span><span class="va">sec_ps_standards</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">standard_name</span>, <span class="va">mp</span>, <span class="va">log_mp</span>, <span class="va">retention_time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 4</span></span></span>
<span><span class="co">#&gt;   standard_name      mp log_mp retention_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PS-3150000    3<span style="text-decoration: underline;">150</span>000   6.50           11.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PS-1870000    1<span style="text-decoration: underline;">870</span>000   6.27           11.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PS-1090000    1<span style="text-decoration: underline;">090</span>000   6.04           12.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PS-630000      <span style="text-decoration: underline;">630</span>000   5.80           12.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> PS-430000      <span style="text-decoration: underline;">430</span>000   5.63           13.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> PS-216000      <span style="text-decoration: underline;">216</span>000   5.33           13.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> PS-120000      <span style="text-decoration: underline;">120</span>000   5.08           14.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> PS-67500        <span style="text-decoration: underline;">67</span>500   4.83           15.0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more rows</span></span></span>
<span></span>
<span><span class="co"># Visualize the calibration curve</span></span>
<span><span class="co"># The relationship between log(MW) and retention time is typically linear</span></span>
<span><span class="co"># or slightly curved, so we fit a polynomial</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sec_ps_standards</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">retention_time</span>, <span class="va">log_mp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"#2E86AB"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#A23B72"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#A23B72"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Retention Time (min)"</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">log</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Polystyrene Calibration Curve"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/calibration-1.png" class="r-plt" alt="" width="672"></p>
<p>Apply the calibration using
<code><a href="../reference/step_sec_conventional_cal.html">step_sec_conventional_cal()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare standards in the format expected by the calibration step</span></span>
<span><span class="co"># Needs columns: retention (time/volume) and log_mw</span></span>
<span><span class="va">ps_cal</span> <span class="op">&lt;-</span> <span class="va">sec_ps_standards</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>retention <span class="op">=</span> <span class="va">retention_time</span>, log_mw <span class="op">=</span> <span class="va">log_mp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rec_cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span></span>
<span>  <span class="va">ri_signal</span> <span class="op">+</span> <span class="va">elution_time</span> <span class="op">+</span> <span class="va">dn_dc</span> <span class="op">~</span> <span class="va">sample_id</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ps_sample</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/roles.html" class="external-link">update_role</a></span><span class="op">(</span><span class="va">sample_id</span>, new_role <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://jameshwade.github.io/measure/reference/step_measure_input_long.html" class="external-link">step_measure_input_long</a></span><span class="op">(</span></span>
<span>    <span class="va">ri_signal</span>,</span>
<span>    location <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">elution_time</span><span class="op">)</span>,</span>
<span>    col_name <span class="op">=</span> <span class="st">"ri"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/step_sec_baseline.html">step_sec_baseline</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="st">"ri"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Apply conventional calibration using polystyrene standards</span></span>
<span>  <span class="co"># This converts retention time to log10(MW) on the x-axis</span></span>
<span>  <span class="co"># fit_type options: "linear", "quadratic", "cubic" (most common)</span></span>
<span>  <span class="fu"><a href="../reference/step_sec_conventional_cal.html">step_sec_conventional_cal</a></span><span class="op">(</span></span>
<span>    standards <span class="op">=</span> <span class="va">ps_cal</span>,</span>
<span>    fit_type <span class="op">=</span> <span class="st">"cubic"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Calculate MW averages from the calibrated chromatogram</span></span>
<span>  <span class="co"># The calibration step converted location values to log10(MW)</span></span>
<span>  <span class="fu"><a href="../reference/step_sec_mw_averages.html">step_sec_mw_averages</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prepped_cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">rec_cal</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Standard at 12.58 has 14.4% MW deviation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Consider removing outlier standards or using a different fit type.</span></span>
<span><span class="co">#&gt; Warning: 1037 points (51.8%) are outside calibration range.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Calibration range: 11.15 to 20.79</span></span>
<span><span class="va">result_cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">prepped_cal</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View molecular weight results</span></span>
<span><span class="co"># New columns are added with mw_ prefix</span></span>
<span><span class="va">result_cal</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">mw_mn</span>, <span class="va">mw_mw</span>, <span class="va">mw_mz</span>, <span class="va">mw_dispersity</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   sample_id      mw_mn   mw_mw   mw_mz mw_dispersity</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PS-50K    419<span style="text-decoration: underline;">927</span>756. 8.24<span style="color: #949494;">e</span>21 7.81<span style="color: #949494;">e</span>23       1.96<span style="color: #949494;">e</span>13</span></span></code></pre></div>
<blockquote>
<p><strong>Important</strong>: Conventional calibration assumes your
sample has similar hydrodynamic behavior to your standards. Polystyrene
standards work well for other flexible polymers in THF, but for proteins
in aqueous SEC, use protein standards or light scattering.</p>
</blockquote>
<hr>
<p><strong>✓ Checkpoint</strong>: You’ve completed a full SEC analysis!
Your <code>result_cal</code> tibble contains molecular weight averages
(Mn, Mw, Mz) and dispersity calculated from your chromatogram using
conventional calibration.</p>
<hr>
</div>
<div class="section level2">
<h2 id="available-steps">Available Steps<a class="anchor" aria-label="anchor" href="#available-steps"></a>
</h2>
<p>The package provides a comprehensive set of recipe steps. Here’s a
quick reference organized by function:</p>
<div class="section level3">
<h3 id="preprocessing">Preprocessing<a class="anchor" aria-label="anchor" href="#preprocessing"></a>
</h3>
<ul>
<li>
<code><a href="../reference/step_sec_baseline.html">step_sec_baseline()</a></code>: SEC-optimized baseline
correction</li>
<li>
<code><a href="../reference/step_sec_detector_delay.html">step_sec_detector_delay()</a></code>: Correct inter-detector
delays</li>
</ul>
</div>
<div class="section level3">
<h3 id="detector-processing">Detector Processing<a class="anchor" aria-label="anchor" href="#detector-processing"></a>
</h3>
<ul>
<li>
<code><a href="../reference/step_sec_ri.html">step_sec_ri()</a></code>: RI detector with dn/dc</li>
<li>
<code><a href="../reference/step_sec_uv.html">step_sec_uv()</a></code>: UV detector with extinction
coefficient</li>
<li>
<code><a href="../reference/step_sec_mals.html">step_sec_mals()</a></code>, <code><a href="../reference/step_sec_lals.html">step_sec_lals()</a></code>,
<code><a href="../reference/step_sec_rals.html">step_sec_rals()</a></code>: Light scattering</li>
<li>
<code><a href="../reference/step_sec_dls.html">step_sec_dls()</a></code>: Dynamic light scattering</li>
<li>
<code><a href="../reference/step_sec_viscometer.html">step_sec_viscometer()</a></code>: Differential viscometer</li>
</ul>
</div>
<div class="section level3">
<h3 id="molecular-weight">Molecular Weight<a class="anchor" aria-label="anchor" href="#molecular-weight"></a>
</h3>
<ul>
<li>
<code><a href="../reference/step_sec_mw_averages.html">step_sec_mw_averages()</a></code>: Mn, Mw, Mz, dispersity</li>
<li>
<code><a href="../reference/step_sec_mw_fractions.html">step_sec_mw_fractions()</a></code>: MW fractions above/below
cutoffs</li>
<li>
<code><a href="../reference/step_sec_mw_distribution.html">step_sec_mw_distribution()</a></code>: Differential/cumulative
MWD</li>
<li>
<code><a href="../reference/step_sec_conventional_cal.html">step_sec_conventional_cal()</a></code>: Narrow standard
calibration</li>
<li>
<code><a href="../reference/step_sec_universal_cal.html">step_sec_universal_cal()</a></code>: Universal calibration</li>
</ul>
</div>
<div class="section level3">
<h3 id="composition-protein">Composition &amp; Protein<a class="anchor" aria-label="anchor" href="#composition-protein"></a>
</h3>
<ul>
<li>
<code><a href="../reference/step_sec_uv_ri_ratio.html">step_sec_uv_ri_ratio()</a></code>: UV/RI ratio for
heterogeneity</li>
<li>
<code><a href="../reference/step_sec_composition.html">step_sec_composition()</a></code>: Copolymer composition</li>
<li>
<code><a href="../reference/step_sec_aggregates.html">step_sec_aggregates()</a></code>: HMWS/monomer/LMWS
quantitation</li>
<li>
<code><a href="../reference/step_sec_protein.html">step_sec_protein()</a></code>: Complete protein SEC workflow</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<p><strong>Common issues and quick fixes:</strong></p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Problem</th>
<th>Solution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>“Column not found”</td>
<td>Check column names match exactly (case-sensitive)</td>
</tr>
<tr class="even">
<td>“No measure columns found”</td>
<td>Add <code><a href="https://jameshwade.github.io/measure/reference/step_measure_input_long.html" class="external-link">step_measure_input_long()</a></code> at the start of your
recipe</td>
</tr>
<tr class="odd">
<td>NA values in MW results</td>
<td>Check calibration range covers your retention times</td>
</tr>
<tr class="even">
<td>Recipe won’t prep</td>
<td>Try prepping with fewer steps to isolate the issue</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Debugging tips:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">your_data</span><span class="op">)</span>                    <span class="co"># Check column names</span></span>
<span><span class="fu">measure</span><span class="fu">::</span><span class="fu"><a href="https://jameshwade.github.io/measure/reference/find_measure_cols.html" class="external-link">find_measure_cols</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>  <span class="co"># Find measure columns after bake</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">ri</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span>         <span class="co"># Inspect chromatogram data</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>Now that you understand the basics, explore these vignettes for
specialized workflows:</p>
<table class="table">
<colgroup>
<col width="29%">
<col width="70%">
</colgroup>
<thead><tr class="header">
<th>Vignette</th>
<th>Use when you need to…</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="triple-detection.html">Multi-Detector SEC</a></td>
<td>Integrate multiple detectors (RI + UV + LS)</td>
</tr>
<tr class="even">
<td><a href="mals-detection.html">MALS Detection</a></td>
<td>Get absolute MW and radius of gyration</td>
</tr>
<tr class="odd">
<td><a href="lals-rals-detection.html">LALS/RALS Detection</a></td>
<td>Use single-angle light scattering</td>
</tr>
<tr class="even">
<td><a href="protein-sec.html">Protein SEC</a></td>
<td>Analyze aggregates (HMWS/monomer/LMWS)</td>
</tr>
<tr class="odd">
<td><a href="copolymer-analysis.html">Copolymer Composition</a></td>
<td>Determine composition via UV/RI ratio</td>
</tr>
<tr class="even">
<td><a href="calibration-management.html">Calibration
Management</a></td>
<td>Save, load, and reuse calibrations</td>
</tr>
<tr class="odd">
<td><a href="system-suitability.html">System Suitability</a></td>
<td>Set up QC checks and column monitoring</td>
</tr>
<tr class="even">
<td><a href="exporting-results.html">Exporting Results</a></td>
<td>Generate summary tables and reports</td>
</tr>
</tbody>
</table>
<p>You can also browse all available functions with:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See all SEC/GPC steps registered with measure</span></span>
<span><span class="fu">measure</span><span class="fu">::</span><span class="fu"><a href="https://jameshwade.github.io/measure/reference/measure_steps.html" class="external-link">measure_steps</a></span><span class="op">(</span>techniques <span class="op">=</span> <span class="st">"SEC/GPC"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_4.0.1          measure.sec_0.0.0.9000 measure_0.0.1.9001    </span></span>
<span><span class="co">#&gt; [4] recipes_1.3.1          dplyr_1.1.4           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.6        xfun_0.55           bslib_0.9.0        </span></span>
<span><span class="co">#&gt;  [4] lattice_0.22-7      vctrs_0.6.5         tools_4.5.2        </span></span>
<span><span class="co">#&gt;  [7] generics_0.1.4      parallel_4.5.2      tibble_3.3.0       </span></span>
<span><span class="co">#&gt; [10] pkgconfig_2.0.3     Matrix_1.7-4        data.table_1.18.0  </span></span>
<span><span class="co">#&gt; [13] RColorBrewer_1.1-3  S7_0.2.1            desc_1.4.3         </span></span>
<span><span class="co">#&gt; [16] lifecycle_1.0.4     compiler_4.5.2      farver_2.1.2       </span></span>
<span><span class="co">#&gt; [19] textshaping_1.0.4   codetools_0.2-20    htmltools_0.5.9    </span></span>
<span><span class="co">#&gt; [22] class_7.3-23        sass_0.4.10         yaml_2.3.12        </span></span>
<span><span class="co">#&gt; [25] prodlim_2025.04.28  tidyr_1.3.2         pillar_1.11.1      </span></span>
<span><span class="co">#&gt; [28] pkgdown_2.2.0       jquerylib_0.1.4     MASS_7.3-65        </span></span>
<span><span class="co">#&gt; [31] cachem_1.1.0        gower_1.0.2         rpart_4.1.24       </span></span>
<span><span class="co">#&gt; [34] nlme_3.1-168        parallelly_1.46.0   lava_1.8.2         </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.2.1    digest_0.6.39       future_1.68.0      </span></span>
<span><span class="co">#&gt; [40] purrr_1.2.0         listenv_0.10.0      labeling_0.4.3     </span></span>
<span><span class="co">#&gt; [43] splines_4.5.2       fastmap_1.2.0       grid_4.5.2         </span></span>
<span><span class="co">#&gt; [46] cli_3.6.5           magrittr_2.0.4      utf8_1.2.6         </span></span>
<span><span class="co">#&gt; [49] survival_3.8-3      future.apply_1.20.1 withr_3.0.2        </span></span>
<span><span class="co">#&gt; [52] scales_1.4.0        lubridate_1.9.4     timechange_0.3.0   </span></span>
<span><span class="co">#&gt; [55] rmarkdown_2.30      globals_0.18.0      nnet_7.3-20        </span></span>
<span><span class="co">#&gt; [58] timeDate_4051.111   ragg_1.5.0          evaluate_1.0.5     </span></span>
<span><span class="co">#&gt; [61] knitr_1.51          hardhat_1.4.2       mgcv_1.9-3         </span></span>
<span><span class="co">#&gt; [64] rlang_1.1.6         Rcpp_1.1.0          glue_1.8.0         </span></span>
<span><span class="co">#&gt; [67] ipred_0.9-15        jsonlite_2.0.0      R6_2.6.1           </span></span>
<span><span class="co">#&gt; [70] systemfonts_1.3.1   fs_1.6.6</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/JamesHWade" class="external-link">James Wade</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
