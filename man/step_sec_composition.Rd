% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_composition.R
\name{step_sec_composition}
\alias{step_sec_composition}
\title{Calculate Copolymer Composition from Detector Signals}
\usage{
step_sec_composition(
  recipe,
  uv_col = NULL,
  ri_col = NULL,
  component_a_uv,
  component_a_ri,
  component_b_uv,
  component_b_ri,
  output_col = "composition_a",
  min_signal = 0.01,
  clip = TRUE,
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("sec_composition")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{uv_col}{Name of the UV detector measure column.}

\item{ri_col}{Name of the RI detector measure column.}

\item{component_a_uv}{UV response factor for component A (extinction coefficient
in mL/(mg*cm) or relative units).}

\item{component_a_ri}{RI response factor for component A (dn/dc in mL/g or
relative units).}

\item{component_b_uv}{UV response factor for component B.}

\item{component_b_ri}{RI response factor for component B.}

\item{output_col}{Name for the output composition column. Default is
\code{"composition_a"}. Contains weight fraction of component A (0-1).}

\item{min_signal}{Minimum signal threshold (as fraction of max) below which
composition is set to NA. Default is 0.01.}

\item{clip}{Logical. Clip composition values to [0, 1] range? Default is \code{TRUE}.}

\item{role}{Role for generated columns.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with the new step added.
}
\description{
\code{step_sec_composition()} creates a \emph{specification} of a recipe step that
calculates the weight fraction of components in a copolymer or blend using
UV and RI detector signals with known response factors.
}
\details{
For a two-component system, the detector signals are:

\deqn{UV = \varepsilon_A \cdot c_A + \varepsilon_B \cdot c_B}
\deqn{RI = (dn/dc)_A \cdot c_A + (dn/dc)_B \cdot c_B}

where c_A and c_B are the concentrations of components A and B.

The weight fraction of component A is calculated by solving this system:

\deqn{w_A = \frac{R_{obs} - R_B}{R_A - R_B}}

where R_obs is the observed UV/RI ratio, and R_A, R_B are the ratios for
pure components (e/dn/dc).

\strong{Common Applications:}
\itemize{
\item Styrene-acrylate copolymers (styrene is UV-active)
\item Block copolymers with different chromophore content
\item PEGylated proteins (protein at 280nm, PEG is UV-transparent)
\item Polymer blends with known compositions
}

\strong{Example Response Factors:}
\itemize{
\item Polystyrene: UV (254nm) ~ 1.0, dn/dc ~ 0.185
\item PMMA: UV (254nm) ~ 0.01, dn/dc ~ 0.084
\item PEG: UV (280nm) ~ 0, dn/dc ~ 0.135
\item Proteins: UV (280nm) ~ 1.0, dn/dc ~ 0.185
}
}
\note{
Response factors must be in consistent units. The absolute values don't
matter as long as the ratios are correct for pure components.
}
\examples{
\dontrun{
library(recipes)
library(measure)

# Styrene-MMA copolymer composition
rec <- recipe(~., data = copolymer_data) |>
  step_measure_input_long(ri_signal, location = vars(elution_time), col_name = "ri") |>
  step_measure_input_long(uv_signal, location = vars(elution_time), col_name = "uv") |>
  step_sec_baseline() |>
  step_sec_composition(
    uv_col = "uv",
    ri_col = "ri",
    component_a_uv = 1.0,    # Styrene (UV-active)
    component_a_ri = 0.185,  # Styrene dn/dc
    component_b_uv = 0.01,   # MMA (weak UV)
    component_b_ri = 0.084,  # MMA dn/dc
    output_col = "styrene_fraction"
  ) |>
  prep()
}
}
\seealso{
Other sec-composition: 
\code{\link{step_sec_uv_ri_ratio}()}
}
\concept{sec-composition}
