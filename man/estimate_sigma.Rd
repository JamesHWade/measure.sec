% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_band_broadening.R
\name{estimate_sigma}
\alias{estimate_sigma}
\title{Estimate Spreading Parameter from Narrow Standard}
\usage{
estimate_sigma(peak, method = c("gaussian", "fwhm", "moments"))
}
\arguments{
\item{peak}{A \code{measure_tbl} or data frame with \code{location} and \code{value}
columns representing a chromatographic peak from a narrow MW standard.}

\item{method}{Method for sigma estimation:
\itemize{
\item \code{"gaussian"} (default): Fit a Gaussian and extract sigma
\item \code{"fwhm"}: Calculate from full width at half maximum (sigma = FWHM / 2.355)
\item \code{"moments"}: Calculate from second moment of the peak
}}
}
\value{
A list with components:
\describe{
\item{sigma}{The estimated spreading parameter (Gaussian std dev)}
\item{tau}{Exponential tail parameter (for EMG model), NA if not applicable}
\item{fwhm}{Full width at half maximum}
\item{asymmetry}{Peak asymmetry factor (> 1 indicates tailing)}
\item{method}{The method used for estimation}
}
}
\description{
Estimates the instrumental spreading parameter (sigma) from a narrow
molecular weight standard peak. This sigma value can then be used in
\code{step_sec_band_broadening()} to correct for band broadening.
}
\details{
The spreading parameter sigma represents the standard deviation of the
instrumental broadening function, assumed to be approximately Gaussian.

For best results, use a narrow polydispersity standard (PDI < 1.05) run
under the same conditions as your samples.

\strong{Method Details:}
\itemize{
\item \strong{gaussian}: Fits a Gaussian function to the peak using nonlinear
least squares. Most accurate for symmetric peaks.
\item \strong{fwhm}: Uses the relationship sigma = FWHM / 2.355 for a Gaussian.
Fast and robust but assumes symmetric peak.
\item \strong{moments}: Calculates sigma from the second central moment.
Accounts for asymmetry but sensitive to baseline.
}
}
\examples{
\dontrun{
# From a measure_tbl
sigma_result <- estimate_sigma(narrow_standard_peak)
sigma_result$sigma

# Use in band broadening correction
rec <- recipe(~., data = sec_data) |>
  step_sec_band_broadening(sigma = sigma_result$sigma)
}
}
