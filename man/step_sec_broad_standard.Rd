% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_broad_standard.R
\name{step_sec_broad_standard}
\alias{step_sec_broad_standard}
\title{Broad Standard Calibration for SEC/GPC}
\usage{
step_sec_broad_standard(
  recipe,
  measures = NULL,
  broad_standard = NULL,
  known_mn = NULL,
  known_mw = NULL,
  fit_type = c("linear", "quadratic"),
  method = c("hamielec", "integral"),
  integration_range = NULL,
  extrapolation = c("warn", "none"),
  output_col = "mw",
  log_output = TRUE,
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("sec_broad_standard")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{measures}{Character vector of measure columns to apply calibration to.
If \code{NULL}, uses all measure columns.}

\item{broad_standard}{A data frame containing the broad standard chromatogram:
\itemize{
\item \code{location} (or \code{time}, \code{volume}, \code{retention}): Elution position
\item \code{value} (or \code{signal}, \code{response}): Detector response
}}

\item{known_mn}{Known number-average molecular weight (Mn) in Daltons.}

\item{known_mw}{Known weight-average molecular weight (Mw) in Daltons.}

\item{fit_type}{Type of calibration curve:
\itemize{
\item \code{"linear"} (default): log10(M) = C1 + C2*V (classic Hamielec)
\item \code{"quadratic"}: log10(M) = C1 + C2\emph{V + C3}V^2
}}

\item{method}{Calibration method:
\itemize{
\item \code{"hamielec"} (default): Optimize to match Mn and Mw
\item \code{"integral"}: Use integral MWD matching (not yet implemented
)
}}

\item{integration_range}{Optional numeric vector \code{c(min, max)} specifying
the elution range to use for the broad standard. If \code{NULL}, auto-detects
peak region.}

\item{extrapolation}{How to handle data outside the calibration range:
\itemize{
\item \code{"warn"} (default): Extrapolate but warn
\item \code{"none"}: Return NA for out-of-range values
}}

\item{output_col}{Name for the output molecular weight column.
Default is \code{"mw"}.}

\item{log_output}{Logical. If \code{TRUE} (default), output column contains
log10(MW). If \code{FALSE}, output contains MW in Daltons.}

\item{role}{Role for generated columns.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with the new step added.
}
\description{
\code{step_sec_broad_standard()} creates a \emph{specification} of a recipe step that
fits a calibration curve using a polydisperse (broad) molecular weight
standard with known Mn and Mw values.
}
\details{
This step implements broad standard calibration methods for SEC/GPC, which
use a single polydisperse standard with known molecular weight averages
instead of multiple narrow standards.

\strong{Hamielec Method:}

Based on Balke, Hamielec, LeClair, and Pearce (1969), this method assumes
a linear calibration relationship:

\deqn{\log_{10}(M) = C_1 + C_2 \cdot V}

The algorithm exploits the fact that dispersity (Mw/Mn) depends only on the
slope C2, while absolute MW values depend on both coefficients:
\enumerate{
\item Optimize C2 to reproduce the known dispersity
\item Then optimize C1 to reproduce the known Mw
}

\strong{When to Use Broad Standard Calibration:}
\itemize{
\item QC labs running the same polymer type repeatedly
\item When narrow standards aren't available for your polymer
\item When you have a well-characterized in-house reference material
\item Provides "absolute" molecular weights for the same polymer type
}

\strong{Limitations:}
\itemize{
\item Results are only valid for polymers with similar hydrodynamic behavior
\item Linear calibration may not fit well over very wide MW ranges
\item Requires well-characterized broad standard (accurate Mn and Mw)
}
}
\examples{
\dontrun{
library(recipes)
library(measure)

# Create broad standard chromatogram data
broad_std <- data.frame(
  time = seq(10, 20, by = 0.1),
  signal = dnorm(seq(10, 20, by = 0.1), mean = 15, sd = 1.5)
)

# Apply broad standard calibration
rec <- recipe(~., data = polymer_data) |>
  step_measure_input_long(ri, location = vars(time), col_name = "ri") |>
  step_sec_baseline() |>
  step_sec_broad_standard(
    broad_standard = broad_std,
    known_mn = 50000,
    known_mw = 150000
  ) |>
  prep()

# Check calibration results
tidy(rec, number = 3)
}
}
\references{
Balke, S.T., Hamielec, A.E., LeClair, B.P., and Pearce, S.L. (1969).
Gel permeation chromatography.
\emph{Industrial & Engineering Chemistry Product Research and Development},
8(1), 54-57.
}
\seealso{
Other sec-calibration: 
\code{\link{sec_calibration_standards}},
\code{\link{sec_pmma_standards}},
\code{\link{sec_ps_standards}},
\code{\link{step_sec_conventional_cal}()},
\code{\link{step_sec_universal_cal}()}
}
\concept{sec-calibration}
