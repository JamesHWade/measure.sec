% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_band_broadening.R
\name{step_sec_band_broadening}
\alias{step_sec_band_broadening}
\title{Band Broadening Correction for SEC}
\usage{
step_sec_band_broadening(
  recipe,
  measures = NULL,
  method = c("tung", "emg"),
  sigma = NULL,
  calibration_peak = NULL,
  tau = NULL,
  iterations = 1,
  damping = 0.5,
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("sec_band_broadening")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{measures}{Character vector of measure column names to process.
If \code{NULL}, all measure columns will be processed.}

\item{method}{Correction method. One of:
\itemize{
\item \code{"tung"} (default): Tung's linear correction
\item \code{"emg"}: Exponentially Modified Gaussian deconvolution
}}

\item{sigma}{Spreading parameter (standard deviation of the instrumental
broadening function) in the same units as the location axis (typically
minutes or mL). If \code{NULL}, must provide \code{calibration_peak}.}

\item{calibration_peak}{A \code{measure_tbl} or data frame with \code{location} and
\code{value} columns representing a narrow standard peak used to estimate sigma.}

\item{tau}{Exponential time constant for EMG method. If \code{NULL} with EMG
method, estimated from \code{calibration_peak}.}

\item{iterations}{Number of iterations for iterative correction. Default is 1
for Tung's method (single pass). Higher values may improve correction but
can introduce instability.}

\item{damping}{Damping factor (0-1) to prevent over-correction and
instability. Default is 0.5. Lower values are more conservative.}

\item{role}{Role for generated columns.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with the new step added.
}
\description{
\code{step_sec_band_broadening()} creates a \emph{specification} of a recipe step that
corrects for axial dispersion (band broadening) in SEC chromatograms. This
improves the accuracy of molecular weight distribution measurements.
}
\details{
Band broadening in SEC occurs due to:
\itemize{
\item Axial diffusion during elution
\item Non-ideal column packing
\item Extra-column volume (tubing, connections, detector cell)
}

This causes:
\itemize{
\item Artificially broadened peaks
\item Underestimated Mn (number-average MW)
\item Overestimated dispersity (Mw/Mn)
}

\strong{Tung's Method} (default):

The observed chromatogram F(V) is related to the true distribution W(V) by:
\deqn{F(V) = \int W(V') G(V - V') dV'}

where G is a Gaussian spreading function with standard deviation sigma.
Tung's linear correction approximates:
\deqn{W(V) \approx F(V) - \sigma^2 \frac{d^2 F(V)}{dV^2}}

\strong{EMG Method}:

Models band broadening as convolution with an Exponentially Modified
Gaussian, which better handles asymmetric peak shapes caused by tailing.

\strong{Sigma Determination}:

The spreading parameter sigma should be determined from a narrow molecular
weight standard (e.g., polystyrene with PDI < 1.05). Use \code{\link[=estimate_sigma]{estimate_sigma()}}
to calculate sigma from such a standard.
}
\note{
\itemize{
\item Correction is applied to the signal, not to molecular weight values
\item Large corrections (> 50\% change in peak width) may indicate
unreliable sigma or poor chromatographic conditions
\item This step preserves the area under the curve (mass conservation)
}
}
\examples{
\dontrun{
library(recipes)
library(measure)

# Using a known sigma value
rec <- recipe(~., data = sec_data) |>
  step_measure_input_long(signal, location = vars(time), col_name = "ri") |>
  step_sec_baseline() |>
  step_sec_band_broadening(sigma = 0.05) |>
  prep()

# Estimating sigma from a narrow standard
narrow_std <- estimate_sigma(narrow_standard_peak)
rec <- recipe(~., data = sec_data) |>
  step_measure_input_long(signal, location = vars(time), col_name = "ri") |>
  step_sec_baseline() |>
  step_sec_band_broadening(sigma = narrow_std$sigma) |>
  prep()
}
}
\references{
Tung, L. H. (1966). Method of calculating molecular weight distribution
function from gel permeation chromatograms. Journal of Applied Polymer
Science, 10(3), 375-385.
}
\seealso{
\code{\link[=estimate_sigma]{estimate_sigma()}} for determining the spreading parameter

Other sec-chromatography: 
\code{\link{step_sec_baseline}()},
\code{\link{step_sec_detector_delay}()},
\code{\link{step_sec_mw_averages}()},
\code{\link{step_sec_mw_distribution}()},
\code{\link{step_sec_mw_fractions}()}
}
\concept{sec-chromatography}
