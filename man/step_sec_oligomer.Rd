% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_oligomer.R
\name{step_sec_oligomer}
\alias{step_sec_oligomer}
\title{Oligomeric Species Analysis for Protein SEC}
\usage{
step_sec_oligomer(
  recipe,
  measures = NULL,
  monomer_mw = NULL,
  peak_detection = c("auto", "manual"),
  peaks = NULL,
  species = c("monomer", "dimer", "trimer", "hmw", "lmw"),
  mw_tolerance = 0.15,
  mw_column = NULL,
  min_area_pct = 0.1,
  output_prefix = "oligo_",
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("sec_oligomer")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{measures}{Character vector of measure columns to analyze. If \code{NULL},
analyzes all measure columns.}

\item{monomer_mw}{Expected monomer molecular weight in Da. Required for
species assignment. Typical range: 10,000 - 1,000,000 Da for proteins.}

\item{peak_detection}{Method for peak detection:
\itemize{
\item \code{"auto"} (default): Automatic peak detection using derivative analysis
\item \code{"manual"}: Use peaks specified in \code{peaks} argument
}}

\item{peaks}{For manual mode, a list or data frame with peak definitions.
Each peak should have \code{start} and \code{end} retention times.}

\item{species}{Character vector of species to identify. Default includes
\code{"monomer"}, \code{"dimer"}, \code{"trimer"}, \code{"hmw"}, \code{"lmw"}.}

\item{mw_tolerance}{Tolerance for MW-based species assignment as a fraction.
Default is 0.15 (15\%). A peak is assigned to "dimer" if its MW is within
15\% of 2x the monomer MW.}

\item{mw_column}{Optional name of a molecular weight measure column (from
MALS or LALS). If provided, uses MW for species assignment; otherwise
uses retention time patterns.}

\item{min_area_pct}{Minimum peak area percentage to report. Peaks below this
threshold are grouped into "other". Default is 0.1 (0.1\%).}

\item{output_prefix}{Prefix for output columns. Default is \code{"oligo_"}.}

\item{role}{Role for generated columns.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with new columns:
\describe{
\item{oligo_monomer_pct}{Percent monomer}
\item{oligo_dimer_pct}{Percent dimer}
\item{oligo_trimer_pct}{Percent trimer}
\item{oligo_hmw_pct}{Percent high molecular weight (> trimer)}
\item{oligo_lmw_pct}{Percent low molecular weight (fragments)}
\item{oligo_species_count}{Number of detected species}
\item{oligo_monomer_mw}{Observed monomer MW (if mw_column provided)}
\item{oligo_dimer_mw}{Observed dimer MW (if mw_column provided)}
}
}
\description{
\code{step_sec_oligomer()} creates a \emph{specification} of a recipe step that
identifies and quantifies individual oligomeric species (monomer, dimer,
trimer, etc.) in protein SEC chromatograms.
}
\details{
This step extends \code{step_sec_aggregates()} by providing detailed species
identification rather than just HMWS/monomer/LMWS classification.

\strong{Species Assignment:}
\itemize{
\item Monomer: MW within \code{mw_tolerance} of \code{monomer_mw}
\item Dimer: MW within \code{mw_tolerance} of 2x \code{monomer_mw}
\item Trimer: MW within \code{mw_tolerance} of 3x \code{monomer_mw}
\item HMW: MW > 3x \code{monomer_mw}
\item LMW: MW < \code{monomer_mw} (fragments, clips)
}

\strong{Peak Detection:}

When using \code{"auto"} detection, peaks are identified using:
\enumerate{
\item Signal derivative analysis
\item Local maxima identification
\item Valley detection for peak boundaries
}

\strong{Without MW Data:}

If no MW column is available, species are assigned based on retention time:
\itemize{
\item Largest peak is assumed to be monomer
\item Earlier-eluting peaks are HMW/oligomers
\item Later-eluting peaks are LMW/fragments
}
}
\note{
For best results:
\itemize{
\item Provide \code{monomer_mw} for accurate species assignment
\item Use with MALS/LALS data for MW-based assignment
\item Ensure good chromatographic resolution between species
}
}
\examples{
\dontrun{
library(recipes)
library(measure)

# Analyze IgG oligomers (monomer MW ~150 kDa)
rec <- recipe(~., data = igg_data) |>
  step_measure_input_long(uv280, location = vars(time), col_name = "uv") |>
  step_sec_baseline() |>
  step_sec_oligomer(monomer_mw = 150000) |>
  prep()

# With MALS-derived MW for accurate assignment
rec <- recipe(~., data = igg_mals_data) |>
  step_measure_input_long(uv280, location = vars(time), col_name = "uv") |>
  step_sec_mals() |>
  step_sec_oligomer(monomer_mw = 150000, mw_column = "mw_mals") |>
  prep()
}
}
\seealso{
\code{\link[=step_sec_aggregates]{step_sec_aggregates()}} for simpler HMWS/monomer/LMWS analysis

Other sec-protein: 
\code{\link{step_sec_aggregates}()},
\code{\link{step_sec_protein}()}
}
\concept{sec-protein}
