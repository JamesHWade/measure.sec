% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_protein.R
\name{step_sec_protein}
\alias{step_sec_protein}
\title{Protein SEC Analysis Workflow}
\usage{
step_sec_protein(
  recipe,
  measures = NULL,
  type = c("native", "denaturing"),
  monomer_mw = NULL,
  monomer_start = NULL,
  monomer_end = NULL,
  extinction_coef = NULL,
  aggregate_threshold = 0.001,
  baseline_method = c("linear", "median", "spline"),
  baseline_left_frac = 0.05,
  baseline_right_frac = 0.05,
  include_oligomer = NULL,
  output_prefix = "protein_",
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("sec_protein")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{measures}{Character vector of measure columns to analyze. If \code{NULL},
analyzes all measure columns.}

\item{type}{Analysis type:
\itemize{
\item \code{"native"} (default): Native conditions (aqueous buffer, non-denaturing)
\item \code{"denaturing"}: Denaturing conditions (e.g., with SDS or guanidine)
}}

\item{monomer_mw}{Expected monomer molecular weight in Da. Required for
oligomer analysis if \code{include_oligomer = TRUE}.}

\item{monomer_start}{Start of the monomer peak region (in location units).
If \code{NULL}, automatically determined.}

\item{monomer_end}{End of the monomer peak region. If \code{NULL}, automatically
determined.}

\item{extinction_coef}{Extinction coefficient for UV-based concentration.
If \code{NULL}, signal remains in raw units.}

\item{aggregate_threshold}{Minimum fraction of signal to report as
aggregate/fragment. Default is 0.001 (0.1\%).}

\item{baseline_method}{Method for baseline correction. One of \code{"linear"}
(default), \code{"median"}, or \code{"spline"}.}

\item{baseline_left_frac}{Fraction of chromatogram start for baseline.
Default is 0.05.}

\item{baseline_right_frac}{Fraction of chromatogram end for baseline.
Default is 0.05.}

\item{include_oligomer}{Logical. Include detailed oligomer analysis?
Default is \code{TRUE} if \code{monomer_mw} is provided.}

\item{output_prefix}{Prefix for output columns. Default is \code{"protein_"}.}

\item{role}{Role for generated columns.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with new columns:
\describe{
\item{protein_hmws_pct}{Percent high molecular weight species}
\item{protein_monomer_pct}{Percent monomer}
\item{protein_lmws_pct}{Percent low molecular weight species}
\item{protein_main_start}{Start of main peak region}
\item{protein_main_end}{End of main peak region}
}

If \code{include_oligomer = TRUE} and \code{monomer_mw} is provided:
\describe{
\item{protein_monomer_oligo_pct}{Percent monomer (from oligomer analysis)}
\item{protein_dimer_pct}{Percent dimer}
\item{protein_trimer_pct}{Percent trimer}
\item{protein_hmw_oligo_pct}{Percent HMW oligomers}
\item{protein_lmw_oligo_pct}{Percent fragments}
\item{protein_species_count}{Number of detected species}
}
}
\description{
\code{step_sec_protein()} creates a \emph{specification} of a recipe step that
provides a streamlined workflow for protein SEC analysis, combining
baseline correction, aggregate quantitation, and optionally oligomer
analysis in a single step.
}
\details{
This step provides a convenient "one-stop" workflow for protein SEC analysis,
suitable for biopharmaceutical characterization. It combines:

1
2. \strong{Aggregate quantitation}: HMWS/monomer/LMWS percentages
3. \strong{Oligomer analysis} (optional): Detailed species identification

\strong{Native vs Denaturing:}
\itemize{
\item \strong{Native}: Preserves quaternary structure; use for oligomer analysis
\item \strong{Denaturing}: Disrupts non-covalent interactions; use for
covalent aggregate detection
}

\strong{Regulatory Context:}
Aggregate analysis is critical for biopharmaceutical characterization:
\itemize{
\item ICH Q6B requires aggregate content specification
\item USP <129> provides guidance on aggregate testing
\item Typical specifications: HMWS < 5\%, Monomer > 95\%
}

\strong{For More Control:}
For advanced analysis or custom workflows, use the individual steps:
\itemize{
\item \code{\link[=step_sec_baseline]{step_sec_baseline()}} for baseline correction
\item \code{\link[=step_sec_uv]{step_sec_uv()}} for UV signal processing
\item \code{\link[=step_sec_aggregates]{step_sec_aggregates()}} for HMWS/monomer/LMWS
\item \code{\link[=step_sec_oligomer]{step_sec_oligomer()}} for detailed species analysis
}
}
\examples{
\dontrun{
library(recipes)
library(measure)

# Basic protein SEC workflow
rec <- recipe(~., data = mab_data) |>
  step_measure_input_long(uv280, location = vars(time), col_name = "uv") |>
  step_sec_protein(monomer_mw = 150000) |>
  prep()

# Native mAb analysis with oligomer detection
rec <- recipe(~., data = mab_data) |>
  step_measure_input_long(uv280, location = vars(time), col_name = "uv") |>
  step_sec_protein(
    type = "native",
    monomer_mw = 150000,
    extinction_coef = 1.4,
    include_oligomer = TRUE
  ) |>
  prep()

# Denaturing conditions (SDS-SEC)
rec <- recipe(~., data = sds_sec_data) |>
  step_measure_input_long(uv280, location = vars(time), col_name = "uv") |>
  step_sec_protein(type = "denaturing", monomer_mw = 150000) |>
  prep()
}
}
\seealso{
\code{\link[=step_sec_aggregates]{step_sec_aggregates()}}, \code{\link[=step_sec_oligomer]{step_sec_oligomer()}}

Other sec-protein: 
\code{\link{step_sec_aggregates}()},
\code{\link{step_sec_oligomer}()}
}
\concept{sec-protein}
