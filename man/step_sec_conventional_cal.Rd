% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_conventional_cal.R
\name{step_sec_conventional_cal}
\alias{step_sec_conventional_cal}
\title{Conventional Calibration for SEC Using Narrow Standards}
\usage{
step_sec_conventional_cal(
  recipe,
  measures = NULL,
  standards = NULL,
  calibration = NULL,
  fit_type = c("cubic", "quadratic", "linear", "fifth", "gam"),
  extrapolation = c("warn", "none", "linear"),
  output_col = "mw",
  log_output = TRUE,
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("sec_conventional_cal")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{measures}{Character vector of measure columns to apply calibration to.
If \code{NULL}, uses all measure columns.}

\item{standards}{A data frame containing calibration standards with columns:
\itemize{
\item \code{location} (or \code{time}, \code{volume}, \code{retention}): Elution position
\item \code{log_mw} (or \code{mw}): Molecular weight (will be log-transformed if \code{mw})
Required unless \code{calibration} is provided.
}}

\item{calibration}{A pre-loaded calibration object from
\code{\link[=load_sec_calibration]{load_sec_calibration()}}. When provided, skips fitting and uses the saved
calibration directly. Takes precedence over \code{standards}.}

\item{fit_type}{Type of fit for the calibration curve:
\itemize{
\item \code{"cubic"} (default): Third-order polynomial
\item \code{"quadratic"}: Second-order polynomial
\item \code{"linear"}: First-order (linear) fit
\item \code{"fifth"}: Fifth-order polynomial
\item \code{"gam"}: Generalized Additive Model with cubic splines (requires mgcv)
}}

\item{extrapolation}{How to handle data outside the calibration range:
\itemize{
\item \code{"warn"} (default): Extrapolate but warn
\item \code{"none"}: Return NA for out-of-range values
\item \code{"linear"}: Use linear extrapolation at boundaries
}}

\item{output_col}{Name for the output molecular weight column.
Default is \code{"mw"}.}

\item{log_output}{Logical. If \code{TRUE} (default), output column contains
log10(MW). If \code{FALSE}, output contains MW in Daltons.}

\item{role}{Role for generated columns.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with the new step added.
}
\description{
\code{step_sec_conventional_cal()} creates a \emph{specification} of a recipe step that
fits a calibration curve from narrow molecular weight standards and applies
it to convert elution time/volume to molecular weight.
}
\details{
This step performs conventional (also called relative) SEC calibration using
narrow dispersity standards of known molecular weight. The calibration curve
relates elution position to log(MW):

\deqn{\log_{10}(M) = f(V_e)}

where f is a polynomial function and V_e is the elution volume or time.

\strong{Calibration Curve Fitting:}

The calibration is fit using orthogonal polynomials for numerical stability.
At least 3 standards are required for cubic fits, 4 for quadratic, etc.

\strong{Important Considerations:}
\itemize{
\item Standards should bracket the MW range of interest
\item Calibration is polymer-specific (different polymers have different
hydrodynamic volumes at the same MW)
\item For cross-polymer comparisons, use universal calibration instead
(\code{\link{step_sec_universal_cal}})
}

\strong{Fit Quality Metrics:}
The \code{tidy()} method returns calibration coefficients and R-squared values
for assessing fit quality. RÂ² > 0.999 is typical for good calibrations.
}
\examples{
\dontrun{
library(recipes)
library(measure)

# Create calibration standards data
ps_standards <- data.frame(
  retention = c(12.5, 13.2, 14.1, 15.0, 16.2, 17.5),
  log_mw = c(6.0, 5.5, 5.0, 4.5, 4.0, 3.5)
)

# Apply conventional calibration
rec <- recipe(~., data = polymer_data) |>
  step_measure_input_long(ri, location = vars(time), col_name = "ri") |>
  step_sec_baseline() |>
  step_sec_conventional_cal(
    standards = ps_standards,
    fit_type = "cubic"
  ) |>
  prep()

# Check calibration quality
tidy(rec, number = 3)
}
}
\seealso{
Other sec-calibration: 
\code{\link{load_sec_calibration}()},
\code{\link{save_sec_calibration}()},
\code{\link{sec_calibration_standards}},
\code{\link{sec_pmma_standards}},
\code{\link{sec_ps_standards}},
\code{\link{step_sec_broad_standard}()},
\code{\link{step_sec_universal_cal}()}
}
\concept{sec-calibration}
