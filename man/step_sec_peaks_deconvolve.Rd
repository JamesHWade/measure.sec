% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_sec_peaks_deconvolve.R
\name{step_sec_peaks_deconvolve}
\alias{step_sec_peaks_deconvolve}
\title{SEC/GPC Peak Deconvolution}
\usage{
step_sec_peaks_deconvolve(
  recipe,
  model = "emg",
  optimizer = "auto",
  max_iter = 500L,
  quality_threshold = 0.9,
  smart_init = TRUE,
  constrain_positions = TRUE,
  peaks_col = ".peaks",
  measures_col = ".measures",
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("sec_peaks_deconvolve")
)
}
\arguments{
\item{recipe}{A recipe object. The step will be added to the sequence of
operations for this recipe.}

\item{model}{Peak model to use:
\itemize{
\item \code{"emg"} (default): Exponentially Modified Gaussian, recommended for SEC
chromatograms with peak tailing
\item \code{"gaussian"}: Symmetric Gaussian, for well-behaved symmetric peaks
\item \code{"bigaussian"}: Bi-Gaussian for flexible asymmetry
}

EMG is the default because chromatographic peaks typically exhibit tailing
due to mass transfer kinetics and column effects.}

\item{optimizer}{Optimization method:
\itemize{
\item \code{"auto"} (default): Selects based on problem complexity
\item \code{"lbfgsb"}: L-BFGS-B (fast, local optimization)
\item \code{"multistart"}: Multiple starts for robustness
\item \code{"nelder_mead"}: Derivative-free simplex method
}}

\item{max_iter}{Maximum iterations for optimization. Default is \code{500}.}

\item{quality_threshold}{Minimum R-squared to accept fit. Default is \code{0.9}
(stricter than base measure default of 0.8 for analytical quality).}

\item{smart_init}{Logical. Use smart initialization based on peak properties.
Default is \code{TRUE}. Highly recommended for SEC data.}

\item{constrain_positions}{Logical. Enforce that peak centers maintain their
relative ordering during optimization. Default is \code{TRUE}.}

\item{peaks_col}{Name of the peaks column. Default is \code{".peaks"}.}

\item{measures_col}{Name of the measures column containing the chromatogram.
Default is \code{".measures"} but often \code{"ri"}, \code{"uv"}, etc. in SEC workflows.}

\item{role}{Not used by this step.}

\item{trained}{A logical to indicate if the step has been trained.}

\item{skip}{A logical. Should the step be skipped when baking?}

\item{id}{A character string that is unique to this step.}
}
\value{
An updated version of \code{recipe} with the new step added. The \code{.peaks}
column will be updated with:
\itemize{
\item Refined peak parameters from curve fitting
\item \code{fit_r_squared}: R-squared of the overall fit
\item \code{area}: Integrated area under the fitted curve (analytical integration)
}
}
\description{
\code{step_sec_peaks_deconvolve()} creates a \emph{specification} of a recipe step
that resolves overlapping peaks in SEC/GPC chromatograms using curve fitting.
This is a thin wrapper around \code{\link[measure:step_measure_peaks_deconvolve]{measure::step_measure_peaks_deconvolve()}}
with SEC-optimized defaults.
}
\details{
Peak deconvolution is essential for SEC/GPC analysis when peaks overlap,
which is common for:
\itemize{
\item Bimodal molecular weight distributions
\item Aggregate/monomer/fragment species in protein SEC
\item Copolymer component separation
}

\strong{EMG Model (Default):}

The Exponentially Modified Gaussian (EMG) is ideal for SEC because it
accounts for the characteristic tailing observed in chromatographic peaks:

\deqn{EMG(x) = h \cdot \exp(\sigma^2/(2\tau^2) + (c-x)/\tau) \cdot
  \Phi((x-c)/\sigma - \sigma/\tau)}

where \eqn{h} is height, \eqn{c} is center, \eqn{\sigma} is Gaussian width,
and \eqn{\tau} is the exponential decay parameter (tailing).

\strong{Quality Assessment:}

The \code{quality_threshold} parameter sets the minimum acceptable R-squared
for fits. The default of 0.9 is stricter than the base measure default,
appropriate for quantitative analytical work.
}
\section{Tidying}{
When you \code{\link[recipes:tidy.recipe]{tidy()}} this step, a tibble with columns
\code{model}, \code{optimizer}, \code{quality_threshold}, and \code{id} is returned.
}

\examples{
\dontrun{
library(recipes)
library(measure)

# SEC peak deconvolution with EMG model (default)
rec <- recipe(~., data = sec_data) |>
  step_measure_input_long(ri_signal, location = vars(elution_volume)) |>
  step_sec_peaks_detect() |>
  step_sec_peaks_deconvolve() |>
  prep()

# Use Gaussian model for symmetric peaks
rec <- recipe(~., data = sec_data) |>
  step_measure_input_long(ri_signal, location = vars(elution_volume)) |>
  step_sec_peaks_detect() |>
  step_sec_peaks_deconvolve(model = "gaussian") |>
  prep()

# Use multistart optimizer for complex multi-peak scenarios
rec <- recipe(~., data = sec_data) |>
  step_measure_input_long(ri_signal, location = vars(elution_volume)) |>
  step_sec_peaks_detect() |>
  step_sec_peaks_deconvolve(optimizer = "multistart") |>
  prep()
}
}
\seealso{
\code{\link[=step_sec_peaks_detect]{step_sec_peaks_detect()}} for SEC-optimized peak detection,
\code{\link[measure:step_measure_peaks_deconvolve]{measure::step_measure_peaks_deconvolve()}} for the underlying implementation.

Other sec-chromatography: 
\code{\link{step_sec_band_broadening}()},
\code{\link{step_sec_baseline}()},
\code{\link{step_sec_detector_delay}()},
\code{\link{step_sec_exclude_regions}()},
\code{\link{step_sec_integration_window}()},
\code{\link{step_sec_mw_averages}()},
\code{\link{step_sec_mw_distribution}()},
\code{\link{step_sec_mw_fractions}()},
\code{\link{step_sec_peaks_detect}()},
\code{\link{step_sec_peaks_refine}()}
}
\concept{sec-chromatography}
