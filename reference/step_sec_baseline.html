<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>SEC/GPC Baseline Correction — step_sec_baseline • measure.sec</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SEC/GPC Baseline Correction — step_sec_baseline"><meta name="description" content="step_sec_baseline() creates a specification of a recipe step
that applies baseline correction optimized for Gel Permeation Chromatography
(GPC) or Size Exclusion Chromatography (SEC) data. This method estimates the
baseline by interpolating between baseline regions at the start and end of
the chromatogram."><meta property="og:description" content="step_sec_baseline() creates a specification of a recipe step
that applies baseline correction optimized for Gel Permeation Chromatography
(GPC) or Size Exclusion Chromatography (SEC) data. This method estimates the
baseline by interpolating between baseline regions at the start and end of
the chromatogram."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">measure.sec</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/sec-analysis.html">Size Exclusion Chromatography Analysis with measure.sec</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JamesHWade/measure-sec/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SEC/GPC Baseline Correction</h1>
      <small class="dont-index">Source: <a href="https://github.com/JamesHWade/measure-sec/blob/main/R/step_sec_baseline.R" class="external-link"><code>R/step_sec_baseline.R</code></a></small>
      <div class="d-none name"><code>step_sec_baseline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>step_sec_baseline()</code> creates a <em>specification</em> of a recipe step
that applies baseline correction optimized for Gel Permeation Chromatography
(GPC) or Size Exclusion Chromatography (SEC) data. This method estimates the
baseline by interpolating between baseline regions at the start and end of
the chromatogram.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">step_sec_baseline</span><span class="op">(</span></span>
<span>  <span class="va">recipe</span>,</span>
<span>  measures <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  left_frac <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  right_frac <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  role <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  trained <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  skip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  id <span class="op">=</span> <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/rand_id.html" class="external-link">rand_id</a></span><span class="op">(</span><span class="st">"sec_baseline"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-recipe">recipe<a class="anchor" aria-label="anchor" href="#arg-recipe"></a></dt>
<dd><p>A recipe object. The step will be added to the sequence of
operations for this recipe.</p></dd>


<dt id="arg-measures">measures<a class="anchor" aria-label="anchor" href="#arg-measures"></a></dt>
<dd><p>An optional character vector of measure column names to
process. If <code>NULL</code> (the default), all measure columns (columns with class
<code>measure_list</code>) will be processed.</p></dd>


<dt id="arg-left-frac">left_frac<a class="anchor" aria-label="anchor" href="#arg-left-frac"></a></dt>
<dd><p>Fraction of points from the beginning to use as the left
baseline region. Default is <code>0.05</code> (first 5% of data points).</p></dd>


<dt id="arg-right-frac">right_frac<a class="anchor" aria-label="anchor" href="#arg-right-frac"></a></dt>
<dd><p>Fraction of points from the end to use as the right
baseline region. Default is <code>0.05</code> (last 5% of data points).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method for baseline estimation. One of:</p><ul><li><p><code>"linear"</code> (default): Linear interpolation between left and right means</p></li>
<li><p><code>"median"</code>: Uses median of baseline regions (more robust to outliers)</p></li>
<li><p><code>"spline"</code>: Smooth spline through baseline regions</p></li>
</ul></dd>


<dt id="arg-role">role<a class="anchor" aria-label="anchor" href="#arg-role"></a></dt>
<dd><p>Not used by this step since no new variables are created.</p></dd>


<dt id="arg-trained">trained<a class="anchor" aria-label="anchor" href="#arg-trained"></a></dt>
<dd><p>A logical to indicate if the quantities for preprocessing
have been estimated.</p></dd>


<dt id="arg-skip">skip<a class="anchor" aria-label="anchor" href="#arg-skip"></a></dt>
<dd><p>A logical. Should the step be skipped when the recipe is baked?</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A character string that is unique to this step to identify it.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated version of <code>recipe</code> with the new step added to the
sequence of any existing operations.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>GPC/SEC chromatograms typically have distinct baseline regions at the
beginning and end where no polymer elutes. This step leverages this
characteristic by:</p><ol><li><p>Identifying baseline regions at the start and end of the chromatogram</p></li>
<li><p>Computing a representative baseline value for each region (mean or median)</p></li>
<li><p>Interpolating between these values to estimate the full baseline</p></li>
<li><p>Subtracting the estimated baseline from the signal</p></li>
</ol><p>The <code>left_frac</code> and <code>right_frac</code> parameters control how much of the
chromatogram is considered "baseline". Choose values that:</p><ul><li><p>Include only the flat, signal-free regions</p></li>
<li><p>Exclude any polymer peaks or system peaks</p></li>
<li><p>Are large enough to average out noise</p></li>
</ul><p>Unlike general-purpose baseline methods like ALS or polynomial fitting,
this approach is specifically designed for the characteristic shape of
GPC/SEC chromatograms and is computationally very fast.</p>
<p><strong>No selectors should be supplied to this step function</strong>. The data should be
in the internal format produced by <code><a href="https://jameshwade.github.io/measure/reference/step_measure_input_wide.html" class="external-link">measure::step_measure_input_wide()</a></code> or
<code><a href="https://jameshwade.github.io/measure/reference/step_measure_input_long.html" class="external-link">measure::step_measure_input_long()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="tidying">Tidying<a class="anchor" aria-label="anchor" href="#tidying"></a></h2>
    <p>When you <code><a href="https://recipes.tidymodels.org/reference/tidy.recipe.html" class="external-link">tidy()</a></code> this step, a tibble with columns
<code>terms</code>, <code>left_frac</code>, <code>right_frac</code>, <code>method</code>, and <code>id</code> is returned.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://jameshwade.github.io/measure/reference/step_measure_baseline_als.html" class="external-link">measure::step_measure_baseline_als()</a></code> for general-purpose baseline
correction, <code><a href="https://jameshwade.github.io/measure/reference/step_measure_detrend.html" class="external-link">measure::step_measure_detrend()</a></code> for simple trend removal.</p>
<p>Other sec-chromatography:
<code><a href="step_sec_band_broadening.html">step_sec_band_broadening()</a></code>,
<code><a href="step_sec_detector_delay.html">step_sec_detector_delay()</a></code>,
<code><a href="step_sec_mw_averages.html">step_sec_mw_averages()</a></code>,
<code><a href="step_sec_mw_distribution.html">step_sec_mw_distribution()</a></code>,
<code><a href="step_sec_mw_fractions.html">step_sec_mw_fractions()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jameshwade.github.io/measure/" class="external-link">measure</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SEC baseline correction with default settings</span></span></span>
<span class="r-in"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">sec_triple_detect</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://jameshwade.github.io/measure/reference/step_measure_input_wide.html" class="external-link">step_measure_input_wide</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"signal_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">step_sec_baseline</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using median method for robustness to outliers</span></span></span>
<span class="r-in"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">sec_triple_detect</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://jameshwade.github.io/measure/reference/step_measure_input_wide.html" class="external-link">step_measure_input_wide</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"signal_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">step_sec_baseline</span><span class="op">(</span>left_frac <span class="op">=</span> <span class="fl">0.1</span>, right_frac <span class="op">=</span> <span class="fl">0.1</span>, method <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Wade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

